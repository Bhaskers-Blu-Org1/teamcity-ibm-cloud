plugins {
    id "java"
    id "com.github.rodm.teamcity-server" version "1.0"
}

ext {
    vendorName = 'IBM Strategic Customer Success'
    teamcityVersion = findProperty('teamcityVersion') ?: '10.0'
}

teamcity {
    version = teamcityVersion

    server {
        descriptor {
            name = project.name
            displayName = 'SoftLayer Plugin'
            version = project.version
            vendorName = project.vendorName
            vendorUrl = 'http://ibm.com'
            description = 'TeamCity SoftLayer Server Plugin'

            downloadUrl = 
                'https://github.ibm.com/StrategicOnboarding/teamcity-softlayer/'
            email = 'scottwn@ibm.com'
            useSeparateClassloader = false

            parameters {
                parameter 'param', 'value'
            }
        }
    }
}


repositories {
    mavenCentral()
}


dependencies {
    provided "org.jetbrains.teamcity.internal:server:$teamcityVersion"
    provided "org.jetbrains.teamcity:cloud-interface:$teamcityVersion"
    provided "org.jetbrains.teamcity:cloud-shared:$teamcityVersion"
    compile 'com.softlayer.api:softlayer-api-client:0.2.5'
}

jar {
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    manifest {
        attributes 'Main-Class': 'ibm.buildServer.clouds.softlayer.ImageList'
    }
}
